GET "libhdr"

// Test for PAIRWISE_ADD (pairwise sum) functionality

LET START() BE
{
    WRITEF("Testing PAIRWISE_ADD with integer vectors*N")

    // Create simple test vector with 4 elements
    LET vec = GETVEC(4)

    // Initialize with test values: [1, 5, 3, 7]
    vec!0 := 1
    vec!1 := 5
    vec!2 := 3
    vec!3 := 7

    WRITEF("Input vector: [%d, %d, %d, %d]*N", vec!0, vec!1, vec!2, vec!3)

    // Test PAIRWISE_ADD - should add adjacent pairs
    // Expected: (1+5)=6, (3+7)=10, so result should be [6, 10]
    LET result = PAIRWISE_ADD(vec)

    WRITEF("PAIRWISE_ADD result: [%d, %d]*N", result!0, result!1)

    // Verify results
    TEST result!0 = 6 THEN $(
        TEST result!1 = 10 THEN $(
            WRITEF("✓ PAIRWISE_ADD test PASSED*N")
        $) ELSE $(
            WRITEF("✗ PAIRWISE_ADD test FAILED - second element*N")
            WRITEF("  Expected: [6, 10]*N")
            WRITEF("  Got:      [%d, %d]*N", result!0, result!1)
        $)
    $) ELSE $(
        WRITEF("✗ PAIRWISE_ADD test FAILED - first element*N")
        WRITEF("  Expected: [6, 10]*N")
        WRITEF("  Got:      [%d, %d]*N", result!0, result!1)
    $)

    WRITEF("*N--- Additional Test Cases ---*N")

    // Test with different values: [2, 4, 6, 8]
    vec!0 := 2
    vec!1 := 4
    vec!2 := 6
    vec!3 := 8

    WRITEF("Second test: [%d, %d, %d, %d]*N", vec!0, vec!1, vec!2, vec!3)
    LET result2 = PAIRWISE_ADD(vec)
    WRITEF("PAIRWISE_ADD result: [%d, %d]*N", result2!0, result2!1)

    // Expected: (2+4)=6, (6+8)=14
    TEST result2!0 = 6 THEN $(
        TEST result2!1 = 14 THEN $(
            WRITEF("✓ Second PAIRWISE_ADD test PASSED*N")
        $) ELSE $(
            WRITEF("✗ Second PAIRWISE_ADD test FAILED - second element*N")
            WRITEF("  Expected: [6, 14]*N")
            WRITEF("  Got:      [%d, %d]*N", result2!0, result2!1)
        $)
    $) ELSE $(
        WRITEF("✗ Second PAIRWISE_ADD test FAILED - first element*N")
        WRITEF("  Expected: [6, 14]*N")
        WRITEF("  Got:      [%d, %d]*N", result2!0, result2!1)
    $)

    WRITEF("*NPAIRWISE_ADD testing completed*N")
}
