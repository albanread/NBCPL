GET "libhdr"

// Performance test for large vector reductions
// Creates two vectors of 10,000 PAIRS filled with random values
// Tests MIN, MAX, and SUM operations on large vectors

LET START() BE
{
    WRITEF("Large Vector Performance Test*N")
    WRITEF("Creating two vectors of 4 PAIRS each...*N")

    // Allocate two PAIRS vectors (4 elements each for debugging)
    LET vec1 = PAIRS 4
    LET vec2 = PAIRS 4

    WRITEF("Vectors allocated successfully*N")

    // Fill vectors with random PAIRS values
    WRITEF("Filling vectors with random values...*N")

    FOR i = 0 TO 3 DO {  // Fill 4 PAIRS
        vec1!i := PAIR(RAND(32000), RAND(32000))     // Proper PAIR element
        vec2!i := PAIR(RAND(32000), RAND(32000))     // Proper PAIR element
    }

    WRITEF("Vectors filled with random data*N")
    WRITEF("Ready for reduction operations*N")
    WRITEF("*N")

    // Display first few values as verification
    WRITEF("First 4 PAIRS from vec1:*N")
    FOR i = 0 TO 3 DO {
        WRITEF("  PAIR %N: %N*N", i, vec1!i)
    }

    WRITEF("*NFirst 4 PAIRS from vec2:*N")
    FOR i = 0 TO 3 DO {
        WRITEF("  PAIR %N: %N*N", i, vec2!i)
    }

    WRITEF("*NPerforming MIN operation...*N")
    LET min_result = MIN(vec1, vec2)
    WRITEF("MIN operation completed*N")

    WRITEF("*NPerforming MAX operation...*N")
    LET max_result = MAX(vec1, vec2)
    WRITEF("MAX operation completed*N")

    WRITEF("*NPerforming SUM operation...*N")
    LET sum_result = SUM(vec1, vec2)
    WRITEF("SUM operation completed*N")

    // Display first few results as verification
    WRITEF("*NFirst 3 MIN results:*N")
    FOR i = 0 TO 2 DO {
        WRITEF("  PAIR %N: %N*N", i, min_result!i)
    }

    WRITEF("*NFirst 3 MAX results:*N")
    FOR i = 0 TO 2 DO {
        WRITEF("  PAIR %N: %N*N", i, max_result!i)
    }

    WRITEF("*NFirst 3 SUM results:*N")
    FOR i = 0 TO 2 DO {
        WRITEF("  PAIR %N: %N*N", i, sum_result!i)
    }

    WRITEF("*NAll operations completed successfully!*N")
}
